{"meta":{"title":"Xingyu Lei","subtitle":"","description":"","author":"Xingyu Lei","url":"http://xingyulei.xyz","root":"/"},"pages":[{"title":"404 Not Found：该页无法显示","date":"2021-04-23T03:34:50.357Z","updated":"2021-02-07T16:58:04.027Z","comments":false,"path":"/404.html","permalink":"http://xingyulei.xyz/404.html","excerpt":"","text":""},{"title":"About Me","date":"2021-08-22T14:55:18.773Z","updated":"2021-08-22T14:55:18.773Z","comments":false,"path":"about/index.html","permalink":"http://xingyulei.xyz/about/index.html","excerpt":"","text":"1234567891011121314151617181920212223242526272829# I am a problem solver and a critical thinker. I have a passion for games and animation.Softwares &#x3D; [ &#39;Maya&#39;, &#39;Unity&#39;, &#39;Motion Builder&#39;, &#39;Houdini&#39;],Skills &#x3D; [ &#39;Python&#39;, &#39;C#&#39;, &#39;Qt&#39;, &#39;OpenGL, GLSL&#39;] Links &#x3D; &#123; &#39;Linkedin&#39;: &#39;https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;xingyu-lei&#x2F;&#39;, &#39;Github&#39;: &#39;https:&#x2F;&#x2F;github.com&#x2F;leixingyu&#39;, &#39;Youtube&#39;: &#39;https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCyLd9tHXOtZDceAZyP8NC4g&#39;, &#39;Vimeo&#39;: &#39;&#39;,&#125;Education &#x3D; [ [Sichuan University, B.S. in Computer Science, 2014-2018], [University of Missouri, B.S. in Information Technology, 2016-2018], [Purdue University, M.S. in Computer Graphics Technology, 2018-2020]]"},{"title":"书单","date":"2021-04-23T03:34:50.357Z","updated":"2021-02-07T16:58:04.030Z","comments":false,"path":"books/index.html","permalink":"http://xingyulei.xyz/books/index.html","excerpt":"","text":""},{"title":"分类","date":"2021-04-23T03:34:50.357Z","updated":"2021-02-07T16:58:04.030Z","comments":false,"path":"categories/index.html","permalink":"http://xingyulei.xyz/categories/index.html","excerpt":"","text":""},{"title":"友情链接","date":"2021-04-23T03:34:50.357Z","updated":"2021-02-07T16:58:04.031Z","comments":true,"path":"links/index.html","permalink":"http://xingyulei.xyz/links/index.html","excerpt":"","text":""},{"title":"Repositories","date":"2021-04-23T03:34:50.419Z","updated":"2021-02-07T16:58:04.032Z","comments":false,"path":"repository/index.html","permalink":"http://xingyulei.xyz/repository/index.html","excerpt":"","text":""},{"title":"标签","date":"2021-04-23T03:34:50.357Z","updated":"2021-02-07T16:58:04.032Z","comments":false,"path":"tags/index.html","permalink":"http://xingyulei.xyz/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"How to organize your own python library (In Progress)","slug":"python-organize-module","date":"2021-08-24T04:00:00.000Z","updated":"2021-08-22T03:04:12.437Z","comments":true,"path":"2021/08/24/python-organize-module/","link":"","permalink":"http://xingyulei.xyz/2021/08/24/python-organize-module/","excerpt":"","text":"Referencehttps://stackoverflow.com/questions/52082078/best-way-to-keep-python-modules-organised","categories":[{"name":"tech summary","slug":"tech-summary","permalink":"http://xingyulei.xyz/categories/tech-summary/"}],"tags":[{"name":"python","slug":"python","permalink":"http://xingyulei.xyz/tags/python/"}]},{"title":"Qt Left Align Icon, Center Align Text (Python)","slug":"qt-button-alignment","date":"2021-08-21T04:00:00.000Z","updated":"2021-08-22T03:39:49.177Z","comments":true,"path":"2021/08/21/qt-button-alignment/","link":"","permalink":"http://xingyulei.xyz/2021/08/21/qt-button-alignment/","excerpt":"","text":"Overriding QPushButton paintEventCreate a subclass from QPushButton called MyButton: 123456789101112131415161718192021class MyButton(QtWidgets.QPushButton): def __init__(self, *args, **kwargs): super(MyButton, self).__init__(*args, **kwargs) def setPixmap(self, pixmap): self.pixmap = pixmap def sizeHint(self): parent_size = QtWidgets.QPushButton.sizeHint(self) return QtCore.QSize(parent_size.width() + self.pixmap.width(), max(parent_size.height(), self.pixmap.height())) def paintEvent(self, event): QtWidgets.QPushButton.paintEvent(self, event) pos_x = 5 # hardcoded horizontal margin pos_y = (self.height() - self.pixmap.height()) / 2 painter = QtGui.QPainter(self) painter.setRenderHint(QtGui.QPainter.Antialiasing, True) painter.setRenderHint(QtGui.QPainter.SmoothPixmapTransform, True) painter.drawPixmap(pos_x, pos_y, self.pixmap) With this method, we no longer use QIcon, we use pixmap instead. 123456789101112131415class TestUI(QtWidgets.QWidget): def __init__(self, parent=None): super(MethodTwo, self).__init__(parent) # initialization object layout = QtWidgets.QGridLayout() pb = MyButton(&#x27;test&#x27;) path = r&quot;xxx&quot; pixmap = QtGui.QPixmap(path).scaled(40, 40, QtCore.Qt.KeepAspectRatio, QtCore.Qt.SmoothTransformation) pb.setPixmap(pixmap) layout.addWidget(pb) self.setLayout(layout) Custom layout inside pushbuttonRemember to send setText signals to textLabel instead of pushButton since this is label within push button’s layout 123456789101112131415161718192021222324class TestUI(QtWidgets.QWidget): def __init__(self, parent=None): super(MethodThree, self).__init__(parent) # initialization object layout = QtWidgets.QGridLayout() pb = QtWidgets.QPushButton() name = &quot;SP_MessageBoxCritical&quot; icon = self.style().standardIcon(getattr(QtWidgets.QStyle, name)) pb.setIcon(icon) pb.setStyleSheet(&#x27;text-align: left;&#x27;) pb.setLayout(QtWidgets.QGridLayout()) label = QtWidgets.QLabel(&#x27;test&#x27;) label.setAlignment(QtCore.Qt.AlignHCenter | QtCore.Qt.AlignVCenter) label.setAttribute(QtCore.Qt.WA_TransparentForMouseEvents, 1) pb_layout = pb.layout() pb_layout.addWidget(label) layout.addWidget(pb) self.setLayout(layout) Use QProxyStyleI haven’t personally test it because I’m using a custom python Qt binding that doesn’t have QProxyStyle included but it’s worth putting it here in case someone is able to try it 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667class ProxyStyle(QtWidgets.QProxyStyle): def drawControl(self, element, option, painter, widget=None): if element == QtWidgets.QStyle.CE_PushButtonLabel: icon = QtGui.QIcon(option.icon) option.icon = QtGui.QIcon() super(ProxyStyle, self).drawControl(element, option, painter, widget) if element == QtWidgets.QStyle.CE_PushButtonLabel: if not icon.isNull(): iconSpacing = 4 mode = ( QtGui.QIcon.Normal if option.state &amp; QtWidgets.QStyle.State_Enabled else QtGui.QIcon.Disabled ) if ( mode == QtGui.QIcon.Normal and option.state &amp; QtWidgets.QStyle.State_HasFocus ): mode = QtGui.QIcon.Active state = QtGui.QIcon.Off if option.state &amp; QtWidgets.QStyle.State_On: state = QtGui.QIcon.On window = widget.window().windowHandle() if widget is not None else None pixmap = icon.pixmap(window, option.iconSize, mode, state) pixmapWidth = pixmap.width() / pixmap.devicePixelRatio() pixmapHeight = pixmap.height() / pixmap.devicePixelRatio() iconRect = QtCore.QRect( QtCore.QPoint(), QtCore.QSize(pixmapWidth, pixmapHeight) ) iconRect.moveCenter(option.rect.center()) iconRect.moveLeft(option.rect.left() + iconSpacing) iconRect = self.visualRect(option.direction, option.rect, iconRect) iconRect.translate( self.proxy().pixelMetric( QtWidgets.QStyle.PM_ButtonShiftHorizontal, option, widget ), self.proxy().pixelMetric( QtWidgets.QStyle.PM_ButtonShiftVertical, option, widget ), ) painter.drawPixmap(iconRect, pixmap)if __name__ == &quot;__main__&quot;: app = QtWidgets.QApplication(sys.argv) app.setStyle(&#x27;fusion&#x27;) proxy_style = ProxyStyle(app.style()) app.setStyle(proxy_style) w = QtWidgets.QWidget() lay = QtWidgets.QVBoxLayout(w) icons = [ app.style().standardIcon(standardIcon) for standardIcon in ( QtWidgets.QStyle.SP_MediaPlay, QtWidgets.QStyle.SP_MediaPause, QtWidgets.QStyle.SP_MediaSeekBackward, QtWidgets.QStyle.SP_MediaSeekForward, ) ] for text, icon in zip(&quot;Play Pause Backward Forward&quot;.split(), (icons)): button = QtWidgets.QPushButton(text) button.setIcon(icon) lay.addWidget(button) w.show() sys.exit(app.exec_()) Referencehttps://stackoverflow.com/questions/44091339/qpushbutton-icon-aligned-left-with-text-centered https://stackoverflow.com/questions/56129402/qpushbutton-icon-left-alignment-text-center-alignment","categories":[{"name":"tech summary","slug":"tech-summary","permalink":"http://xingyulei.xyz/categories/tech-summary/"}],"tags":[{"name":"pyqt","slug":"pyqt","permalink":"http://xingyulei.xyz/tags/pyqt/"}]},{"title":"Constant in Python","slug":"python-constant","date":"2021-07-16T04:00:00.000Z","updated":"2021-08-22T02:25:23.915Z","comments":true,"path":"2021/07/16/python-constant/","link":"","permalink":"http://xingyulei.xyz/2021/07/16/python-constant/","excerpt":"","text":"IntroI recently saw some codes written by another tech artist, and he made a module called constant.py In it stored all the global variables and all the import modules, something like this: 12345678910111213141516#constant.pyimport module_aimport module_bimport module_cGLOBAL_VAR_MAX = 50GLOBAL_VAR_MIN = 10GLOBAL_VAR_TIMEOUT = 2000GLOBAL_NAME = r&#x27;random name&#x27;# or evenclass Constant(object): gravity = 9.8 is_true = True With this setup, all the module in the same project would just import the constant module and have access toall the imports and variable. I thought this was a neat way to make code cleaner by getting rid of all the duplicated importsthat might happened. But turns out that there’s a lot of people against doing things like this. Constant in Pythonthe root level where the constant lives actually matters: based on the style guide: Constants are usually defined on a module level and written in all capital letters with underscores separating words. Examples include MAX_OVERFLOW and TOTAL. also suggestions have mentioned to refrain from using class as it could be instantiated which makes no sense. (maybe a static class in another language would work) Separate module for importDespite the root level of constant this, is it a good practice to have a separate module for import? No, unless there’s a valid reason for all those modules to be collected under a common name. If not, then they shouldbe kept separately. This is due to documentation, as other people open your file, they don’t get information onwhat is getting imported (what is needed) Same module import multiple timesSo if multiple files are importing the same module separately, does python optimize the import? Yes, python modules are considered as singletons, no matter how many times you import them they get initialized only once.unless reload is being called Reference https://stackoverflow.com/questions/5027400/constants-in-python-at-the-root-of-the-module-or-in-a-namespace-inside-the-modu https://stackoverflow.com/questions/40419582/in-python-do-you-need-to-import-modules-in-each-split-file https://stackoverflow.com/questions/6206204/python-importing-an-import-file https://stackoverflow.com/questions/296036/does-python-optimize-modules-when-they-are-imported-multiple-times","categories":[{"name":"learning log","slug":"learning-log","permalink":"http://xingyulei.xyz/categories/learning-log/"}],"tags":[{"name":"python","slug":"python","permalink":"http://xingyulei.xyz/tags/python/"}]},{"title":"Qt Using Role to Embed Data","slug":"qt-data-role","date":"2021-05-04T04:00:00.000Z","updated":"2021-08-22T02:35:20.581Z","comments":true,"path":"2021/05/04/qt-data-role/","link":"","permalink":"http://xingyulei.xyz/2021/05/04/qt-data-role/","excerpt":"","text":"Different Data Role has different usage, for some widget items, it is possible todisplay one information, while embedding different information. The example below shows that you can set UserRole to a QTreeWidgetItem that nevergets displayed, but the data (one or more) can be retrieved anytime. 123456789101112131415161718192021222324252627282930313233343536373839404142import sysimport osfrom PyQt5 import QtCorefrom PyQt5.QtWidgets import QApplication, QWidget, QVBoxLayout, QTreeWidgetItem, QTreeWidgetclass UI(QWidget): def __init__(self): super(UI, self).__init__(None) layout = QVBoxLayout() treeWidget = QTreeWidget() treeWidget.setHeaderLabels([&quot;Files&quot;]) layout.addWidget(treeWidget) for i in range(10): filename = &#x27;maya_scene_%02d.ma&#x27; % i item = QTreeWidgetItem([filename]) item.setCheckState(0, QtCore.Qt.Checked) # I want to store the full path as meta data on the tree widget # item. This way it&#x27;s easier to read the information displayed # in the UI. item.setData(0, QtCore.Qt.UserRole, os.path.join(r&#x27;C:\\users&#x27;, filename)) item.setData(1, QtCore.Qt.UserRole, &#123;&#x27;key&#x27;: &#x27;apple&#x27;&#125;) treeWidget.addTopLevelItem(item) treeWidget.currentItemChanged.connect(self.displayFullPath) self.setLayout(layout) def displayFullPath(self, item): print item.text(0) d = item.data(1, QtCore.Qt.UserRole) print &#x27;key&#x27;, d[&#x27;key&#x27;] print item.data(0, QtCore.Qt.UserRole)if __name__ == &#x27;__main__&#x27;: app = QApplication(sys.argv) ui = UI() ui.show() app.exec_() Reference: https://doc.qt.io/qt-5/qt.html#ItemDataRole-enum","categories":[{"name":"tech summary","slug":"tech-summary","permalink":"http://xingyulei.xyz/categories/tech-summary/"}],"tags":[{"name":"pyqt","slug":"pyqt","permalink":"http://xingyulei.xyz/tags/pyqt/"}]},{"title":"QWidget Template (without .ui file)","slug":"qt-widget-template","date":"2021-02-18T05:00:00.000Z","updated":"2021-08-18T04:00:58.131Z","comments":true,"path":"2021/02/18/qt-widget-template/","link":"","permalink":"http://xingyulei.xyz/2021/02/18/qt-widget-template/","excerpt":"","text":"Sometimes you need a quick window to display some information,but the built-in qt message boxes aren’t suitable for the job. Temporary WidgetYou can choose to create a widget class, but also for saving time, you can createa temporary custom widget example: 123456789101112131415161718192021222324252627282930313233343536373839404142434445class MainWidget(QtWidgets.QMainWindow): def __init__(self, parent=None): self.connectSignal() def connectSignal(self): self.someBtn.clicked.connect(self.openCustomWidget) def openCustomWidget(self): # initialize with a widget and a layout self.customWidget = QtWidgets.QWidget() layout = QtWidgets.QHBoxLayout(self.customWidget) # title self.customWidget.setWindowTitle(&#x27;Error Log&#x27;) # set window display behavior self.customWidget.setWindowFlags(QtCore.Qt.WindowStaysOnTopHint) # set window icon (using a built-in icon) name = &quot;SP_MessageBoxCritical&quot; style = self.customWidget.style() icon = style.standardIcon(getattr(QtWidgets.QStyle, name)) self.customWidget.setWindowIcon(icon) # add custom elements here message = &quot;happy new year&quot; errorLabel = QtWidgets.QLabel(messages) scrollArea = QtWidgets.QScrollArea() scrollArea.setWidgetResizable(True) scrollArea.setWidget(errorLabel) # finalize layout.addWidget(scrollArea) self.customWidget.show()def showWindow(): win = MainWidget() try: win.close() except: pass win.setAttribute(QtCore.Qt.WA_DeleteOnClose) win.show() Couple of things worth noting: correctly initialize the widget self.customWidget = QtWidgets.QWidget() will allow widget be child of the main window, thus allow widget to close when main window is closed so not customWidget = QtWidgets.QWidget() or self.customWidget = QtWidgets.QWidget(self) use getattr in combination with QStyle and name of the built-in icon use win.setAttribute(QtCore.Qt.WA_DeleteOnClose) to make sure the child widget is killedafter main window is closed, because default close only hides window objects self.customWidget.show() is the core command to call it to display Referencehttps://www.programiz.com/python-programming/methods/built-in/getattrhttps://forum.learnpyqt.com/t/are-there-any-built-in-qicons/185/2","categories":[{"name":"tech summary","slug":"tech-summary","permalink":"http://xingyulei.xyz/categories/tech-summary/"}],"tags":[{"name":"pyqt","slug":"pyqt","permalink":"http://xingyulei.xyz/tags/pyqt/"}]},{"title":"QDialog Template (without .ui file)","slug":"qt-dialog-template","date":"2021-02-11T05:00:00.000Z","updated":"2021-08-18T04:00:58.135Z","comments":true,"path":"2021/02/11/qt-dialog-template/","link":"","permalink":"http://xingyulei.xyz/2021/02/11/qt-dialog-template/","excerpt":"","text":"Main Window1234567891011121314151617class AttrConnectWindow(QtWidgets.QMainWindow): def __init__(self, parent=getMainWindow()): super(AttrConnectWindow, self).__init__(parent) list = [&#x27;apple&#x27;, &#x27;banana&#x27;, &#x27;pear&#x27;] dialog = NamespaceEditDialog() dialog.setNamespaceCBox(list) # only when self.accept() is returned if dialog.exec_(): print &#x27;accepted&#x27; text = dialog.getText() option = dialog.getCombo() print text, option Dialog123456789101112131415161718192021222324252627282930class NamespaceEditDialog(QtWidgets.QDialog): def __init__(self, parent=None): super(NamespaceEditDialog, self).__init__(parent) # Create widgets self.namespaceCBox = QtWidgets.QComboBox() self.namespaceEdit = QtWidgets.QLineEdit() self.acceptButton = QtWidgets.QPushButton(&quot;Confirm&quot;) # Create layout and add widgets layout = QtWidgets.QGridLayout() layout.addWidget(self.namespaceCBox, 0, 0) layout.addWidget(self.namespaceEdit, 0, 1) layout.addWidget(self.acceptButton, 1, 1) # Set dialog layout self.setLayout(layout) self.acceptButton.clicked.connect(self.onClickAccept) def onClickAccept(self): self.accept() def getNamespaceEdit(self): return self.namespaceEdit.text() def getNamespaceCBox(self): return self.namespaceCBox.currentText() def setNamespaceCBox(self, items): self.namespaceCBox.addItems(items)","categories":[{"name":"tech summary","slug":"tech-summary","permalink":"http://xingyulei.xyz/categories/tech-summary/"}],"tags":[{"name":"pyqt","slug":"pyqt","permalink":"http://xingyulei.xyz/tags/pyqt/"}]},{"title":"Qt Model View List Model","slug":"qt-mv-list","date":"2021-02-07T05:00:00.000Z","updated":"2021-08-18T03:55:46.916Z","comments":true,"path":"2021/02/07/qt-mv-list/","link":"","permalink":"http://xingyulei.xyz/2021/02/07/qt-mv-list/","excerpt":"","text":"The following example demonstrates how to create custom list model fordisplaying list-like data 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293from Qt import QtGui, QtCore, QtWidgetsimport sysclass PaletteListModel(QtCore.QAbstractListModel): def __init__(self, colors=[], parent=None): QtCore.QAbstractListModel.__init__(self, parent) self.__colors = colors def headerData(self, section, orientation, role): # orientation: indicates horizontal or vertical header # section: indicates which index on the header if role == QtCore.Qt.DisplayRole: if orientation == QtCore.Qt.Horizontal: return &#x27;Palette&#x27; else: return &#x27;Color &#123;&#125;&#x27;.format(section+1) def rowCount(self, parent): # parent: are for tree view with hierarchical structure return len(self.__colors) def data(self, index, role): # display data for each index, of each data role if role == QtCore.Qt.EditRole: return self.__colors[index.row()].name() if role == QtCore.Qt.ToolTipRole: return &quot;Hex code: &quot;+self.__colors[index.row()].name() if role == QtCore.Qt.DecorationRole: row = index.row() value = self.__colors[row] pixmap = QtGui.QPixmap(26, 26) pixmap.fill(value) icon = QtGui.QIcon(pixmap) return icon if role == QtCore.Qt.DisplayRole: row = index.row() value = self.__colors[row] return value.name() def flags(self, index): return QtCore.Qt.ItemIsEditable | QtCore.Qt.ItemIsEnabled | QtCore.Qt.ItemIsSelectable def setData(self, index, value, role=QtCore.Qt.EditRole): # set data for each index of the value, data role is set to edit role default if role == QtCore.Qt.EditRole: row = index.row() color = QtGui.QColor(value) if color.isValid(): self.__colors[row] = color # have to emit and dataChanged signal to sync with display self.dataChanged.emit(index, index) return True return False def insertRows(self, position, rows, parent=QtCore.QModelIndex()): self.beginInsertRows(parent, position, position+rows-1) for i in range(rows): self.__colors.insert(position, QtGui.QColor(&quot;#000000&quot;)) self.endInsertRows() return True def removeRows(self, position, rows, parent=QtCore.QModelIndex()): self.beginRemoveRows(parent, position, position+rows-1) for i in range(rows): value = self.__colors[position] self.__colors.remove(value) self.endRemoveRows() return Trueif __name__ == &#x27;__main__&#x27;: app = QtWidgets.QApplication(sys.argv) red = QtGui.QColor(255, 0, 0) green = QtGui.QColor(0, 255, 0) blue = QtGui.QColor(0, 0, 255) model = PaletteListModel([red, green, blue]) model.insertRows(0, 5) listView = QtWidgets.QListView() listView.show() listView.setModel(model) sys.exit(app.exec_()) Note Since parent is used for hierarchical structure, it is not set or set to null indexin this example. index is a QModelIndex instance to locate data in model In setData(), make sure to add self.dataChanged.emit(index, index) for syncing data change For inserting and removing rows always starts with insertRows/removeRows andclose with endInsertRows/endRemoveRows so that view and model is in-sync no parent in list view so pass a null index: QModelIndex() essentially, it is modifying the self.__colors which is displayed in data() Sourcehttps://www.youtube.com/watch?v=mCHVI8OXDxw&amp;list=PLG4y4w32mF3qmweFe59P_8INlVNOm_IHohttps://doc.qt.io/qtforpython-5.12/PySide2/QtCore/QModelIndex.html#PySide2.QtCore.QModelIndex","categories":[{"name":"learning log","slug":"learning-log","permalink":"http://xingyulei.xyz/categories/learning-log/"}],"tags":[{"name":"pyqt","slug":"pyqt","permalink":"http://xingyulei.xyz/tags/pyqt/"}]},{"title":"Qt Model View Intro","slug":"qt-mv-intro","date":"2021-02-06T05:00:00.000Z","updated":"2021-08-18T03:55:46.911Z","comments":true,"path":"2021/02/06/qt-mv-intro/","link":"","permalink":"http://xingyulei.xyz/2021/02/06/qt-mv-intro/","excerpt":"","text":"The following example demonstrated how same data is accessed through a Modeland shared across Views 1234567891011121314151617181920from Qt import QtGui, QtCore, QtWidgetsimport sysif __name__ == &#x27;__main__&#x27;: app = QtWidgets.QApplication(sys.argv) # no QString needed in Qt5, use python string instead data = [&#x27;one&#x27;, &#x27;two&#x27;, &#x27;three&#x27;] listView = QtWidgets.QListView() listView.show() model = QtCore.QStringListModel(data) listView.setModel(model) combobox = QtWidgets.QComboBox() combobox.setModel(model) combobox.show() sys.exit(app.exec_()) In Qt5, the QtCore.QStringList() is replaced by python’s built-in string type 123456# qt 4data = QtCore.QStringList()data &lt;&lt; &quot;one&quot; &lt;&lt; &quot;two&quot; &lt;&lt; &quot;three&quot; &lt;&lt; &quot;four&quot; &lt;&lt; &quot;five&quot;# qt 5data = [&#x27;one&#x27;, &#x27;two&#x27;, &#x27;three&#x27;, &#x27;four&#x27;, &#x27;five&#x27;] Sourcehttps://www.youtube.com/watch?v=mCHVI8OXDxw&amp;list=PLG4y4w32mF3qmweFe59P_8INlVNOm_IHohttps://stackoverflow.com/questions/27757678/importerror-cannot-import-name-qstringlist-in-pyqt5","categories":[{"name":"learning log","slug":"learning-log","permalink":"http://xingyulei.xyz/categories/learning-log/"}],"tags":[{"name":"pyqt","slug":"pyqt","permalink":"http://xingyulei.xyz/tags/pyqt/"}]},{"title":"Qt Context Menu & Sub-menu","slug":"qt-context-menu","date":"2021-02-05T05:00:00.000Z","updated":"2021-08-18T03:58:51.919Z","comments":true,"path":"2021/02/05/qt-context-menu/","link":"","permalink":"http://xingyulei.xyz/2021/02/05/qt-context-menu/","excerpt":"","text":"12345678910111213141516171819202122232425262728293031323334353637383940414243class MainWindow(): def __init__(self): pass def setup(self): self.widget.setContextMenuPolicy(QtCore.Qt.CustomContextMenu) def connectionSignal(self): self.widget.customContextMenuRequested.connect(self.openContextMenu) def openContextMenu(self): contextMenu = QtWidgets.QMenu() # Enable options when only certain number of row is selected (typically one) selectedIndexes = list(set([item.row() for item in self.widget.selectedIndexes()])) if len(selectedIndexes) == 1: item = self.widget.currentItem() # menu option functionAction = contextMenu.addAction(&#x27;Menu Text go here&#x27;) functionAction.triggered.connect(lambda: self.execFunctionWithArgs(item)) # menu option with sub-menu functionMenu = contextMenu.addMenu(&#x27;More options here!&#x27;) submenu = functionMenu.addAction(&#x27;Sub Menu here&#x27;) submenu.triggered.connect(lambda: self.execFunctionWithArgs(item)) else: items = self.widget.selectedItems() # Enable options for other senarios anotherAction = contextMenu.addAction(&#x27;Menu Text go here&#x27;) anotherAction.triggered.connect(self.execFunction) cursor = QtGui.QCursor() contextMenu.exec_(cursor.pos()) def execFunctionWithArgs(self, argument): pass def execFunction(self): pass Referencehttps://stackoverflow.com/questions/13799033/how-to-add-submenu-in-qt","categories":[{"name":"tech summary","slug":"tech-summary","permalink":"http://xingyulei.xyz/categories/tech-summary/"}],"tags":[{"name":"pyqt","slug":"pyqt","permalink":"http://xingyulei.xyz/tags/pyqt/"}]},{"title":"Qt Quick MessageBox","slug":"qt-messagebox","date":"2021-01-28T05:00:00.000Z","updated":"2021-08-18T03:57:51.057Z","comments":true,"path":"2021/01/28/qt-messagebox/","link":"","permalink":"http://xingyulei.xyz/2021/01/28/qt-messagebox/","excerpt":"","text":"Using self reference in class 1234567891011121314151617181920212223242526272829class MainWindow(): def __init__(self): pass def _messageBoxCritical(self, message, title=&#x27;Error&#x27;): msgBox = QtWidgets.QMessageBox(self) msgBox.setIcon(QtWidgets.QMessageBox.Critical) msgBox.setWindowTitle(title) msgBox.setText(message) msgBox.setStandardButtons(QtWidgets.QMessageBox.Ok) return msgBox.exec_() def _messageBoxYesNo(self, message, title=&#x27;&#x27;): msgBox = QtWidgets.QMessageBox(self) msgBox.setIcon(QtWidgets.QMessageBox.Question) msgBox.setWindowTitle(title) msgBox.setText(message) msgBox.setStandardButtons(QtWidgets.QMessageBox.Yes|QtWidgets.QMessageBox.No) userChoice = msgBox.exec_() return userChoice def _messageBoxOk(self, message, title=&#x27;&#x27;): msgBox = QtWidgets.QMessageBox(self) msgBox.setIcon(QtWidgets.QMessageBox.Information) msgBox.setWindowTitle(title) msgBox.setText(message) msgBox.setStandardButtons(QtWidgets.QMessageBox.Ok) return msgBox.exec_() Using it outside of class or in class as static method 123456789101112131415161718192021222324def messageBoxCritical(message, title=&#x27;Error&#x27;): msgBox = QtWidgets.QMessageBox() msgBox.setIcon(QtWidgets.QMessageBox.Critical) msgBox.setWindowTitle(title) msgBox.setText(message) msgBox.setStandardButtons(QtWidgets.QMessageBox.Ok) return msgBox.exec_()def messageBoxYesNo(message, title=&#x27;&#x27;): msgBox = QtWidgets.QMessageBox() msgBox.setIcon(QtWidgets.QMessageBox.Question) msgBox.setWindowTitle(title) msgBox.setText(message) msgBox.setStandardButtons(QtWidgets.QMessageBox.Yes|QtWidgets.QMessageBox.No) userChoice = msgBox.exec_() return userChoicedef messageBoxOk(message, title=&#x27;&#x27;): msgBox = QtWidgets.QMessageBox() msgBox.setIcon(QtWidgets.QMessageBox.Information) msgBox.setWindowTitle(title) msgBox.setText(message) msgBox.setStandardButtons(QtWidgets.QMessageBox.Ok) return msgBox.exec_() Usage: 12345678910msg = &quot;Did you recieve this message?&quot;# within classuserChoice = self._messageBoxYesNo(msg, title=&#x27;Test Title&#x27;)# static methoduserChoice = MainWindow._messageBoxYesNo(msg, title=&#x27;Test Title&#x27;)# call outside classuserChoice = messageBoxYesNo(msg, title=&#x27;Test Title&#x27;)if userChoice == QtWidgets.QMessageBox.Yes: function() “Self” as parameter in PyQt5 PyQt5 self reference","categories":[{"name":"tech summary","slug":"tech-summary","permalink":"http://xingyulei.xyz/categories/tech-summary/"}],"tags":[{"name":"pyqt","slug":"pyqt","permalink":"http://xingyulei.xyz/tags/pyqt/"}]},{"title":"Error Handling in Python","slug":"python-error-handle","date":"2021-01-24T05:00:00.000Z","updated":"2021-08-11T03:27:00.046Z","comments":true,"path":"2021/01/24/python-error-handle/","link":"","permalink":"http://xingyulei.xyz/2021/01/24/python-error-handle/","excerpt":"","text":"Error Handlingfinally will guarantee execution in try-exception-finally block even after return raise Raise error back to parent function 12345678910111213141516171819202122232425262728# eg. this line will give an ZeroDivision Error10 / 0# what if this belongs to a function and we want to raise the# error code to let whatever calls it to handle instead of itself# so instead ofdef occur_error(): try: output = 10 / 0 except ZeroDivisionError: # error handling pass# we do thisdef handle_error(): try: occur_error() except ZeroDivisionError: # error handling passdef occur_error(): try: output = 10 / 0 except ZeroDivisionError: raise ZeroDivisionError Referencehttps://stackoverflow.com/questions/49262379/does-finally-always-execute-in-python","categories":[{"name":"learning log","slug":"learning-log","permalink":"http://xingyulei.xyz/categories/learning-log/"}],"tags":[{"name":"python","slug":"python","permalink":"http://xingyulei.xyz/tags/python/"}]},{"title":"Qt Custom Sorting","slug":"pyqt-sorting","date":"2021-01-23T05:00:00.000Z","updated":"2021-08-11T03:25:14.883Z","comments":true,"path":"2021/01/23/pyqt-sorting/","link":"","permalink":"http://xingyulei.xyz/2021/01/23/pyqt-sorting/","excerpt":"","text":"Sorting OverviewSorting happens a lot in qt viewports like list, table and tree. Usingconvenience class such as item-based widget provides limited sorting options. One common thing may occur when you are sorting items is the widget treats theirvalue as string instead of int, which will result incorrect ordering 12345678910111213141516list = [&quot;3&quot;, &quot;1&quot;, &quot;2&quot;, &quot;20&quot;, &quot;92&quot;, &quot;89&quot;, &quot;40&quot;, &quot;10&quot;, &quot;11&quot;]if __name__ == &#x27;__main__&#x27;: app = QtWidgets.QApplication(sys.argv) mywidget = QtWidgets.QTableWidget() mywidget.insertColumn(0) for index in range(len(list)): mywidget.insertRow(index) value = list[index] item = QtWidgets.QTableWidgetItem(value) mywidget.setItem(index, 0, item) mywidget.sortItems(0, QtCore.Qt.AscendingOrder) mywidget.show() sys.exit(app.exec_()) This will sort the list of items based on their string, so the order will be: 1234- 1- 10- 11- 2 instead of 123- 1- 2- ... So naturally, you would need to specify the item value as integer type,but you cannot instantiate item with integer, but setData() will work 1234# intead of item = QtWidgets.QTableWidgetItem(int(value))# do thisitem.setData(QtCore.Qt.ItemDataRole, int(value)) Now everything will sort by numeric order Custom Sorting (Operator override)What if you need more than numeric value for your data, for example, when displaying frame number, you would like to include frame rangetoo. Like frame 1, frame 2, frame 3-7, frame 8, frame 9-14. It looks like using stringis the only option. This time you need to override value compare operator for these value, that is makingyour own item class like the following example 123456789class MyTableWidgetItem(QtWidgets.QTableWidgetItem): def __init__(self, parent=None): QtWidgets.QTableWidgetItem.__init__(self, parent) def __lt__(self, otherItem): try: return int(self.text().split(&#x27;-&#x27;)[0]) &lt; int(otherItem.text().split(&#x27;-&#x27;)[0]) except ValueError: return self.text() &lt; otherItem.text() the __lt__ is the less than operator&lt; 12345678910111213141516list = [&quot;1&quot;, &quot;2&quot;, &quot;10&quot;, &quot;11&quot;, &quot;14-15&quot;, &quot;120&quot;, &quot;100-115&quot;, &quot;59-62&quot;]if __name__ == &#x27;__main__&#x27;: app = QtWidgets.QApplication(sys.argv) mywidget = QtWidgets.QTableWidget() mywidget.insertColumn(0) for index in range(len(list)): mywidget.insertRow(index) value = list[index] item = MyTableWidgetItem(value) mywidget.setItem(index, 0, item) mywidget.sortItems(0, QtCore.Qt.AscendingOrder) mywidget.show() sys.exit(app.exec_()) Everything should behave correctly Custom Sorting (QSortFilterProxyModel Class)Referencehttps://stackoverflow.com/questions/363200/is-it-possible-to-sort-numbers-in-a-qtreewidget-column","categories":[{"name":"tech summary","slug":"tech-summary","permalink":"http://xingyulei.xyz/categories/tech-summary/"}],"tags":[{"name":"pyqt","slug":"pyqt","permalink":"http://xingyulei.xyz/tags/pyqt/"}]},{"title":"How to use Dunder in Python","slug":"python-dunder","date":"2021-01-23T05:00:00.000Z","updated":"2021-08-22T02:41:43.892Z","comments":true,"path":"2021/01/23/python-dunder/","link":"","permalink":"http://xingyulei.xyz/2021/01/23/python-dunder/","excerpt":"","text":"Underscore NamingSingle Leading Underscore: _var Indicating a name is protected, for internal use. Not enforced by python interpreter Double Leading Underscore: __var Indicating a name is private. Enforced by interpreter, attempt to call it will trigger AttributeError Double Leading Trailing Underscore: __var__ Special methods (magic methods) defined by python language, avoid naming your own attribute Single Trailing Underscore: var_ Avoid naming conflict with python keywords Single Underscore: _ Temporary variable name, variables that are never used example: 1234a, b, c, d = ([] for _ in range(4))for _ in random_list: some_operation() Referencehttps://dbader.org/blog/meaning-of-underscores-in-python#https://www.tutorialsteacher.com/python/public-private-protected-modifiers","categories":[{"name":"learning log","slug":"learning-log","permalink":"http://xingyulei.xyz/categories/learning-log/"}],"tags":[{"name":"python","slug":"python","permalink":"http://xingyulei.xyz/tags/python/"}]},{"title":"Override vs. Overload","slug":"override-overload","date":"2021-01-17T05:00:00.000Z","updated":"2021-08-18T03:55:00.982Z","comments":true,"path":"2021/01/17/override-overload/","link":"","permalink":"http://xingyulei.xyz/2021/01/17/override-overload/","excerpt":"","text":"OverloadOverload sounds like a hearthstone term to me, I should really stop playing it. Overloading occurs when two or more methods in one class have the samemethod name but different parameters. Python supports the following: Built-in function overloading User defined function overloading Operator overloading OverrideOverriding means having two methods with the same method name and parameters(i.e., method signature). One of the methods is in the parent class and theother is in the child class. Overriding allows a child class to provide a specificimplementation of a method that is already provided its parent class. OverwriteOverwrite can be confusing, but it means destroying (replacing) the thing it isoverwriting. Referencehttps://www.programcreek.com/2009/02/overriding-and-overloading-in-java-with-examples/ https://stackabuse.com/overloading-functions-and-operators-in-python/","categories":[{"name":"learning log","slug":"learning-log","permalink":"http://xingyulei.xyz/categories/learning-log/"}],"tags":[{"name":"python","slug":"python","permalink":"http://xingyulei.xyz/tags/python/"}]},{"title":"Maya Qt Template","slug":"pyqt-template","date":"2021-01-16T05:00:00.000Z","updated":"2021-08-11T03:25:40.435Z","comments":true,"path":"2021/01/16/pyqt-template/","link":"","permalink":"http://xingyulei.xyz/2021/01/16/pyqt-template/","excerpt":"","text":"PyQt import12from Qt import QtCore, QtGui, QtWidgetsfrom Qt import _loadUi Maya (in-application)Qt window parented to Maya main window 12345678910111213# moduleName.pyfrom shiboken2 import wrapInstancedef get_maya_main_window(): import maya.OpenMayaUI main_window_ptr = maya.OpenMayaUI.MQtUtil.mainWindow() return wrapInstance(long(main_window_ptr), QtWidgets.QMainWindow)class ModuleUI(QtWidgets.QDialog): def __init__(self, parent=get_maya_main_window()): super(ModuleUI, self).__init__(parent) _loadUi(UI_PATH, self) self.setWindowFlags(QtCore.Qt.Window) Qt window not parented to Maya main window 12345# moduleName.pyclass ModuleUI(QtWidgets.QDialog): def __init__(self): super(ModuleUI, self).__init__() _loadUi(UI_PATH, self) After that you can implement the open window function note: by default, closing the widget is hiding not destroying the object 1234567891011121314# hiding the windowdef show(): window = ModuleUI() window.show()# destroying the window objectdef show(): window = ModuleUI() try: window.close() except: pass window.setAttribute(QtCore.Qt.WA_DeleteOnClose) window.show() And in Maya script editor to call the open window function 12# in maya script editormoduleName.show() When the UI has no parent (Maya main window), it will get instantly destoryed by thegarbage collector, unless you keep an instance: 12345678# in the show functiondef show(): window = ModuleUI() window.show() return window# in maya script editorwin = moduleName.show() System application1234567891011121314# appName.pyclass AppUI(QtWidgets.QDialog): def __init__(self): super(AppUI, self).__init__() _loadUi(UI_PATH, self) if __name__ == &#x27;__main__&#x27;: import sys app = QtWidgets.QApplication(sys.argv) window = AppUI() window.show() sys.exit(app.exec_()) Without using .ui file12345678910111213141516171819202122232425262728293031323334class InheritQWidget(QtWidgets.QWidget): def __init__(self, parent=None): super(InheritQWidget, self).__init__(parent) # initialization object layout = QtWidgets.QGridLayout() listWidget = QtWidgets.QListWidget() #treeWidget = QtWidgets.QTreeWidget() # set # treeWidget.setParent(listWidget) layout.addWidget(listWidget) self.setLayout(layout) listWidget.addItem(&#x27;item A&#x27;) listWidget.addItem(&#x27;item B&#x27;)class InheritQMainWindow(QtWidgets.QMainWindow): # Window inherits from QMainWindow the layout is already defined # to accommodate any toolbars or any other QMainWindow component # use the setCentralWidget() to accommodate this def __init__(self, parent=None): super(InheritQMainWindow, self).__init__(parent) # initialization object widget = QtWidgets.QWidget() layout = QtWidgets.QGridLayout() # set self.setCentralWidget(widget) widget.setLayout(layout) label = QtWidgets.QLabel(&#x27;test&#x27;) layout.addWidget(label, 0, 0) There is a different between inheriting from QWdiget class vs QMainWindow Error in PyCharmWhen this error occurs, it is due to MayaDevKit environmentMayaDevKit allows maya python command auto-completion, remove it from PyCharm 12app &#x3D; QtWidgets.QApplication(sys.argv)TypeError: &#39;NoneType&#39; object is not callable https://www.reddit.com/r/learnpython/comments/jyw8z1/pyqt5_why_do_i_get_an_empty_window/https://stackoverflow.com/questions/58925453/pycharm-use-pyside2-typeerror-nonetype-object-is-not-callable","categories":[{"name":"tech summary","slug":"tech-summary","permalink":"http://xingyulei.xyz/categories/tech-summary/"}],"tags":[{"name":"pyqt","slug":"pyqt","permalink":"http://xingyulei.xyz/tags/pyqt/"}]},{"title":"Import in Python","slug":"python-import","date":"2021-01-16T05:00:00.000Z","updated":"2021-08-22T02:08:08.874Z","comments":true,"path":"2021/01/16/python-import/","link":"","permalink":"http://xingyulei.xyz/2021/01/16/python-import/","excerpt":"","text":"from … import … or import …Always avoid wildcard imports like such as it will pollute namespaces: 1from my_module import * Instead use regular import like: 1import my_module Using wildcard import will not import names with a leading underscore (unless the module defines an __all__ list) It is also suggested by PEP8 __init__.py when importing__init__.py is used to specify a package, when import is trying to find the modules,But it is not required: meaning a package without __init__.py,The system can still find the modules after configuring appropriate PYTHONPATH usingsys.path.append. __init__.py is executed after importing the package, I’ve seensub-directory being imported by appending as environment variable within __init__.py so instead of this file structure with import like import project.foo.bar 123456project&#x2F; __init__.py foo&#x2F; __init__.py bar&#x2F; b.py inside the __init__.py, it could do a sys.path.append(PATH_TO_BAR) so with this file structure, you can just do import project they could even add the import statement for you in the __init__.py, although it is not transparent. 12345project&#x2F; __init__.py foo&#x2F; bar&#x2F; b.py Also, it seems like whats ever getting appended last overrides the previousenv variable, so import to the same name module will find the latest append Dot notation in Import12345678910parent&#x2F; __init__.py file.py one&#x2F; __init__.py anotherfile.py two&#x2F; __init__.py three&#x2F; __init__.py Each dot in your import will refer to something inside the package, could be another packageor a module. But it can’t be a class. Import python modules could look like:import parent.file or import parent.one.anotherfile From … import classes or functions look like this:from parent.file import classwhich gives you direct access to the class namespace, but not the example above. Import OrderBased on PEP8, imports should be grouped by the following order: Standard library import Related third-party import Local application/library specific import What is Standard Library Imports? Standard library are installed automatically by Python installer, full documentation linkis here: https://docs.python.org/3/library/ What is the order after grouping? There is no specific rules, but based on common preferences, use alphabetical order, withimport first and from … import after 12345import abcimport defimport xfrom g import ggfrom x import xx Intra-PackageIn a structure like this, how would you do import from another directory?say from module-x.py import module-a 12345678910top-package&#x2F; __init__.py sub-package-a&#x2F; __init__.py module-x.py module-y.py sub-package-b&#x2F; __init__.py module-a.py module-b.py Here’s some examples doing relative imports in module-x 1234567891011import module-yfrom . import module-yfrom .module-y import classfrom .. import sub-package-bfrom ..subpackage-b import module-afrom ..subpackage-b.module-a import class ##Referencehttps://docs.python.org/3/tutorial/modules.htmlhttps://stackoverflow.com/questions/37974843/why-can-i-import-successfully-without-init-pyhttps://stackoverflow.com/questions/9427037/relative-path-not-working-even-with-init-py","categories":[{"name":"learning log","slug":"learning-log","permalink":"http://xingyulei.xyz/categories/learning-log/"}],"tags":[{"name":"python","slug":"python","permalink":"http://xingyulei.xyz/tags/python/"}]},{"title":"Conditional Expression & List Comprehension","slug":"conditional-expression","date":"2021-01-06T05:00:00.000Z","updated":"2021-01-11T02:18:35.144Z","comments":true,"path":"2021/01/06/conditional-expression/","link":"","permalink":"http://xingyulei.xyz/2021/01/06/conditional-expression/","excerpt":"","text":"Conditional ExpressionConditional Expression (also known as Ternary Operators) Example: 1234if condition: value = value_if_trueelse: value = value_if_false this can be re-written as: 1value = value_if_true if condition else value_if_false List ComprehensionExample 123list = []for item in items: list.append(item) this can be re-written as: 1list = [item for item in items] it can also be combined with statements and operations 1list = [operate_func(item) for item in items if condition] However, list comprehension is meant for creating list, not executing multiple operations 1234[operation() for _ in steps] # Wrongfor _ in steps: # Do this instead operation()","categories":[{"name":"tech summary","slug":"tech-summary","permalink":"http://xingyulei.xyz/categories/tech-summary/"}],"tags":[{"name":"python","slug":"python","permalink":"http://xingyulei.xyz/tags/python/"},{"name":"style","slug":"style","permalink":"http://xingyulei.xyz/tags/style/"}]},{"title":"Learning Git","slug":"git-learning","date":"2020-12-22T05:00:00.000Z","updated":"2021-01-11T02:17:10.967Z","comments":true,"path":"2020/12/22/git-learning/","link":"","permalink":"http://xingyulei.xyz/2020/12/22/git-learning/","excerpt":"","text":"DVCS vs. CVCSDVCS (distributed version control system), for example: Git. Each developer are getting a complete copy of the entire history of that project. This allows developer works offline without connecting to the master repo. Git has an additional staging phase which allows you to break down changes into seperate commits with its own comments. CVCS (centralized version control system), for example: SVN. One central repository, gives manager more top down approach to control, security permission. No staging phase means one less step. Note: today, more teams are using a Centralized Git Model, where changes intended to be a part of a project are submitted as pull or merge request to the master branch. GitHub vs. GitLabThey are completely different web-based Git repositories. On the surface, it looks like GitHub is really community friendly, hosting the largest version control platform, while GitLab offers great deal for enterprise professional use (equally, or better features like tracking, project import, with cheaper prices) Git SSH protocolGit Tricky Commands git init vs. git clone git init is a setup process where you initialize a bare local repo git clone obtain a local development clone repo from an already setup central repository, which can be treated as combining git init and git remote add git pull (or git push) vs. pull request (or push request) git pull pull the changes from the remote repo to your local repo, which is effectively a git fetch followed by a git merge pull request is you requesting another repo to pull your change (more or less asking them to git pull from your repo). A push request is the other way around, where the target repo ask you to git push your changes git config this command allows you to configure your Git configuration on a global or local project level, some common usage includes setting up name and email, configure text color or editor choice. There are three configuration level: --local, --global, --system 123# examplegit --global user.name &quot;John Doh&quot;git --system core.editor vim Note: most config only need to be set once, email is an exception where you will want to use personal email for personal project and professional email for work-related project Resource https://blog.hackbrightacademy.com/blog/svn-vs-git/#:~:text=The%20difference%20between%20Git%20and%20SVN%20version%20control%20systems%20is,well%20as%20some%20local%20repositories. https://www.atlassian.com/git/tutorials/what-is-git https://www.perforce.com/blog/vcs/git-vs-perforce-how-choose-and-when-use-both https://usersnap.com/blog/gitlab-github/ https://stackoverflow.com/questions/22585407/git-pull-vs-pull-request","categories":[{"name":"learning log","slug":"learning-log","permalink":"http://xingyulei.xyz/categories/learning-log/"}],"tags":[{"name":"git","slug":"git","permalink":"http://xingyulei.xyz/tags/git/"},{"name":"version control","slug":"version-control","permalink":"http://xingyulei.xyz/tags/version-control/"}]},{"title":"Field vs. Property","slug":"field-property","date":"2020-12-20T05:00:00.000Z","updated":"2021-02-28T00:58:20.264Z","comments":true,"path":"2020/12/20/field-property/","link":"","permalink":"http://xingyulei.xyz/2020/12/20/field-property/","excerpt":"","text":"Field vs. Propertysharp123456789101112131415# c#public class Person&#123; private string _name; // this is a field public string Name // this is a property &#123; get&#123; return _name; &#125; set&#123; _name = value; &#125; &#125; public int Age&#123; get;set; &#125; // AutoProperty generates private field for us&#125; 1234567891011121314151617181920212223# pythonclass Celsius(object): def __init__(self, temperature=0): self._temperature = temperature # this is a protected field @property def temperature(self): print(&quot;Getting value...&quot;) return self._temperature @temperature.setter def temperature(self, value): print(&quot;Setting value...&quot;) if value &lt; -273.15: raise ValueError(&quot;Temperature below -273 is not possible&quot;) self._temperature = value# in this case, access the protected temperature valuehuman = Celsius(37)# gettemperature = human.temperature # note that this is not calling a method# set/modifyhuman.temperature = 36.5 Field which stores the internal data should almost always be private. Property gives access to field (or exposed field). Above provides an example of field and property as well as a short-hand for get &amp; set, and AutoProperty in C#. The python example, use the decorator @property for getting value, use @name.setter: name is the property name.In this case: @temperature.setter. There is also a deleter. https://www.w3schools.com/cs/cs_properties.asphttps://medium.com/omarelgabrys-blog/properties-vs-fields-in-c-6cec86c59dc9https://www.freecodecamp.org/news/python-property-decorator/","categories":[{"name":"learning log","slug":"learning-log","permalink":"http://xingyulei.xyz/categories/learning-log/"}],"tags":[{"name":"python","slug":"python","permalink":"http://xingyulei.xyz/tags/python/"},{"name":"c#","slug":"c","permalink":"http://xingyulei.xyz/tags/c/"}]},{"title":"Structure vs. Class","slug":"structure-class","date":"2020-12-20T05:00:00.000Z","updated":"2021-01-11T02:24:41.239Z","comments":true,"path":"2020/12/20/structure-class/","link":"","permalink":"http://xingyulei.xyz/2020/12/20/structure-class/","excerpt":"","text":"Struct vs. Classsharp123456789# this is a structpublic struct Coord&#123; public Coord(float x, float y)&#123; X = x; Y = y; &#125; public float X &#123; get; &#125; public float Y &#123; get; &#125;&#125; sharp123456789# this is a classpublic class Person&#123; public Person(string name, int age)&#123; Name = name; Age = age; &#125; public string Name &#123; get; set; &#125; public int Age &#123; get; set; &#125;&#125; Structure types have value semantics. That is, a variable of a structure type contains an instance of the type. By default, variable values are copied on assignment, passing an argument to a method, and returning a method result. In the case of a structure-type variable, an instance of the type is copied Because structure type have value semantics, it is recommended using “readonly” to declare structure type as immutable. Class types have reference semantics. That is, a variable of a class type contains a reference to an instance of the type, not the instance itself. Therefore, the following example shows the different use cases. sharp123456789Person Jack = new Person(&quot;Jack&quot;, 28);Jack.Name = &quot;Jackson&quot;;Console.WriteLine(Jack.Name);Coord origin = new Coord(0, 0);Console.WriteLine(origin.X);origin.X = 5; // error! the return value X is not a variable // it is actrually the copy of the instanceorigin = new Coord(5, 0); // clear! can only set new X this way https://stackoverflow.com/questions/1747654/error-cannot-modify-the-return-value-c-sharphttps://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/struct","categories":[{"name":"learning log","slug":"learning-log","permalink":"http://xingyulei.xyz/categories/learning-log/"}],"tags":[{"name":"c#","slug":"c","permalink":"http://xingyulei.xyz/tags/c/"}]},{"title":"Verlet Integration","slug":"verlet-integration","date":"2020-11-19T05:00:00.000Z","updated":"2021-01-11T02:23:26.119Z","comments":true,"path":"2020/11/19/verlet-integration/","link":"","permalink":"http://xingyulei.xyz/2020/11/19/verlet-integration/","excerpt":"","text":"Verlet integration:IntroductionWhen simulating a particle movement, I naturally think of Euler integration, where the position of the particle can be expressed as such: (free falling motion) $$x = 0.5gt^2$$This is an extremly easy use case. The position of the particle can be represented using a function of time. But in real life, a particle can be affected by multiple forces (and even unstabled force caused non-constant acceleration) and Euler integration also has inaccurate estimation when time step is very large. In my understanding, the use of Verlet is good for complex particle movement. What it essentially does is relate force with position rather than velocity. The process first calculate the current particle position and the position one step back: $$velocity = Xcurrent-Xprevious;$$ $$Xprevious = Xcurrent;Xcurrent = Xcurrent+velocity$$ This works magically, here’s some sample code to help understand it. sharp1234// without other influence, the following updates the particle positionvelocity = posNow - posOld;posOld = posNow;posNow += velocity; Calculate ForceWhat if we want to add gravity to the particle like the free falling above? Just add the acceleration to the current position, and the change will add-up on the next integration. The following also applies to forces like friction. 1posNow += GRAVITY; // not sure if we should multipy Time.deltatime ConstraintConstraint are usually in the form of constraining particles to a specific distance, like spring. When mulitple constraints acts on single particle, one constraint will affect the other. To solve this, loop the constraint multiple time for each time step. sharp123456789101112131415161718192021222324252627for (int count = 0; count &lt; ITERATION; count++)&#123; Constriants();&#125;// constraint on rope to make fixed distance between segmentsvoid Constriants()&#123; for(int index = 0; index &lt; segment-1; index++) &#123; float distance = (currentSeg.posNow - nextSeg.posNow).magnitude; float error = Mathf.Abs(distance - ropeDist); Vector2 changeDir = Vector2.zero; if (distance &gt; ropeDist) changeDir = (currentSeg.posNow - nextSeg.posNow).normalized; else if (distance &lt; ropeDist) changeDir = (nextSeg.posNow - currentSeg.posNow).normalized; Vector2 changeAmount = changeDir * error; if (index == 0) nextSeg.posNow += changeAmount; else&#123; currentSeg.posNow -= changeAmount * 0.5f; nextSeg.posNow += changeAmount * 0.5f; &#125; &#125;&#125; CollisionPenalty based system or projection collision reaction sharp12345678910111213141516171819// example for bounding box collisionVector2 velocity = posNow - posOld;if (posNow.x &gt; screenWidth)&#123; posNow.x = screenWidth; posOld.x = posNow.x + velocity.x;&#125;else if (posNow.x &lt; 0)&#123; posNow.x = 0; posOld.x = posNow.x + velocity.x;&#125;if (posNow.y &gt; screenWidth)&#123; posNow.y = screenWidth; posOld.y = posNow.y + velocity.y;&#125;else if (posNow.y &lt; 0)&#123; posNow.y = 0; posOld.y = posNow.y + velocity.y;&#125; Demohttps://sheldonlei.itch.io/rope-simulation Resourceshttps://youtu.be/3HjO_RGIjCUhttps://www.youtube.com/watch?v=FcnvwtyxLdshttps://en.wikipedia.org/wiki/Verlet_integration#Velocity_Verlet","categories":[{"name":"tech summary","slug":"tech-summary","permalink":"http://xingyulei.xyz/categories/tech-summary/"}],"tags":[{"name":"Unity","slug":"Unity","permalink":"http://xingyulei.xyz/tags/Unity/"},{"name":"integration","slug":"integration","permalink":"http://xingyulei.xyz/tags/integration/"},{"name":"C#","slug":"C","permalink":"http://xingyulei.xyz/tags/C/"}]},{"title":"Maya Python API (3. Custom Deformer)","slug":"maya-api-3","date":"2019-11-11T05:00:00.000Z","updated":"2021-01-11T02:45:12.975Z","comments":true,"path":"2019/11/11/maya-api-3/","link":"","permalink":"http://xingyulei.xyz/2019/11/11/maya-api-3/","excerpt":"","text":"General FormatCustom deformer SampleAPI 1.0 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152import sysimport mathimport maya.cmds as cmdsimport maya.OpenMaya as omimport maya.OpenMayaMPx as mpxnodeName = &#x27;myFirstDeformer&#x27;nodeID = om.MTypeId(0x55555)class MyDeformer(mpx.MPxDeformerNode): amplitudeAttr = om.MObject() displacementAttr = om.MObject() matrixAttr = om.MObject() def __init__(self): mpx.MPxDeformerNode.__init__(self) def deform(self, dataBlock, geomIterator, localToWorldMatrix, geomIndex): # step 1: access built-in attribute value using attribute name and attribute handle envelopeAttr = mpx.cvar.MPxGeometryFilter_envelope envelopeHandle = dataBlock.inputValue(envelopeAttr) envelopeValue = envelopeHandle.asFloat() # step 1.5: access custom attribute value amplitudeHandle = dataBlock.inputValue(MyDeformer.amplitudeAttr) amplitudeValue = amplitudeHandle.asFloat() displacementHandle = dataBlock.inputValue(MyDeformer.displacementAttr) displacementValue = displacementHandle.asFloat() # step 1.55: access custom attribute value connected to an accessory node matrixHandle = dataBlock.inputValue(MyDeformer.matrixAttr) matrixValue = matrixHandle.asMatrix() transMatrix = om.MTransformationMatrix(matrixValue) # matrix type translateValue = transMatrix.getTranslation(om.MSpace.kObject) # vector type # step 2: access input mesh inputMesh = self.getDeformerInputGeom(dataBlock, geomIndex) # step 2.5: access mesh normals meshFn = om.MFnMesh(inputMesh) normalVectorArray = om.MFloatVectorArray() # create float vector array to store normal vector meshFn.getVertexNormals(False, normalVectorArray, om.MSpace.kObject) # (average normal or not?, the array to store, normal space) # step 3: iterate the mesh vertices and deform it newVertexPosArray = om.MPointArray() # to store new vertices position while not geomIterator.isDone(): vertexPos = geomIterator.position() vertexIndex = geomIterator.index() normalVector = om.MVector(normalVectorArray[vertexIndex]) # get weight from weightPainting and multiply it to the deform, this is done inside # built-in function weightValue(dataBlock, geomIndex, vertexIndex) weight = self.weightValue(dataBlock, geomIndex, vertexIndex) vertexPos.x = vertexPos.x + math.sin(vertexIndex + displacementValue + translateValue[0]) * normalVector.x * amplitudeValue * envelopeValue * weight vertexPos.y = vertexPos.y + math.sin(vertexIndex + displacementValue + translateValue[0]) * normalVector.y * amplitudeValue * envelopeValue * weight vertexPos.z = vertexPos.z + math.sin(vertexIndex + displacementValue + translateValue[0]) * normalVector.z * amplitudeValue * envelopeValue * weight newVertexPosArray.append(vertexPos) geomIterator.next() geomIterator.setAllPositions(newVertexPosArray) # override built-in function that allows to create accessory node along with deformer def accessoryNodeSetup(self, dagModifier): # step1: create the accessory node using the supplied dagModifier locator = dagModifier.createNode(&#x27;locator&#x27;) # step2: access accessory node&#x27;s attribute(can&#x27;t use mplug type, has to be mobject type) # access dependency node function set dependNodeFn = om.MFnDependencyNode(locator) matrixPlug = dependNodeFn.findPlug(&#x27;worldMatrix&#x27;) # this returns mplug type attribute, we need mobject type attribute matrixAttr = matrixPlug.attribute() # step3: connect mobject type(required) together # param: accessory node(mobject), accessory attr(mobject), deformer node(mobject: using self.thisMObject()), deformer attr(mobject) mConnectStatus = dagModifier.connect(locator, matrixAttr, self.thisMObject(), MyDeformer.matrixAttr) &#x27;&#x27;&#x27;now the accessory node&#x27;s worldMatrix is driving to the in-matrix of the deformer node&#x27;&#x27;&#x27; return mConnectStatus def accessoryAttribute(self): # returns the deformer node attribute connected return MyDeformer.matrixAttr def getDeformerInputGeom(self, dataBlock, geomIndex): inputAttr = mpx.cvar.MPxGeometryFilter_input inputHandle = dataBlock.outputArrayValue(inputAttr) # use outputArray instead of inputArray to avoid re-computation inputHandle.jumpToElement(geomIndex) inputElementHandle = inputHandle.outputValue() inputGeomAttr = mpx.cvar.MPxGeometryFilter_inputGeom inputGeomHandle = inputElementHandle.child(inputGeomAttr) # this is different from how we usually get handler inputGeomMesh = inputGeomHandle.asMesh() return inputGeomMeshdef nodeCreator(): # return pointer to instance of our deformer node class return mpx.asMPxPtr(MyDeformer())def nodeInitializer(): # step1: define attribute function set (numericAttr &amp; matrixAttr) numericAttrFn = om.MFnNumericAttribute() matrixAttrFn = om.MFnMatrixAttribute() # step2: create custom attribute and set its property MyDeformer.amplitudeAttr = numericAttrFn.create(&#x27;ampplitude&#x27;, &#x27;amp&#x27;, om.MFnNumericData.kFloat, 0.0) numericAttrFn.setMin(-1.0) numericAttrFn.setMax(1.0) numericAttrFn.setReadable(False) MyDeformer.displacementAttr = numericAttrFn.create(&#x27;displacement&#x27;, &#x27;dis&#x27;, om.MFnNumericData.kFloat, 0.0) numericAttrFn.setMin(-5.0) numericAttrFn.setMax(5.0) numericAttrFn.setReadable(False) MyDeformer.matrixAttr = matrixAttrFn.create(&#x27;matrix&#x27;, &#x27;m&#x27;) matrixAttrFn.setStorable(False) matrixAttrFn.setConnectable(True) # step2.5: access built-in attribute using OpenMayaMpx.cvar.MPxGeometryFilter_outputGeom outputGeom = mpx.cvar.MPxGeometryFilter_outputGeom # step3: attach attribute MyDeformer.addAttribute(MyDeformer.amplitudeAttr) MyDeformer.addAttribute(MyDeformer.displacementAttr) MyDeformer.addAttribute(MyDeformer.matrixAttr) # step4: add circuit (relationship) MyDeformer.attributeAffects(MyDeformer.amplitudeAttr, outputGeom) MyDeformer.attributeAffects(MyDeformer.displacementAttr, outputGeom) MyDeformer.attributeAffects(MyDeformer.matrixAttr, outputGeom) cmds.makePaintable(nodeName, &#x27;weights&#x27;, attrType=&#x27;multiFloat&#x27;, shapeMode=&#x27;deformer&#x27;)def initializePlugin(mobject): mplugin = mpx.MFnPlugin(mobject) try: # Parameter: node_name, node_id, node_creatorFunc, node_initFuc, nodeType(common type include-kDeformerNode, kDependNode) mplugin.registerNode(nodeName, nodeID, nodeCreator, nodeInitializer, mpx.MPxNode.kDeformerNode) except: sys.stderr(&#x27;fail to register node: &#x27; + nodeName) raisedef uninitializePlugin(mobject): mplugin = mpx.MFnPlugin(mobject) try: mplugin.deregisterNode(nodeID) except: sys.stderr(&#x27;fail to de-register node: &#x27; + nodeName) raise Node: MPxDeformerNode is only available in API 2.0 Custom Attribute vs. Built-in AttributeIn the last chapter, we know how to create custom numeric type attribute using MFnNumericAttribute. Sometimes in our node, we want to access existing built-in attribute. We do so by using OpenMayaMPx.cvar.MPxDeformerNode_(attributeName) before Maya 2016, we use OpenMayaMPx.cvar.MPxGeometryFilter_(attributeName) after 2016. Obtain Input GeometryIn the sample code, we define our custom function getDeformerInputGeom(self, dataBlock, geomIndex) to obtain the input mesh to the deformer node. We will discuss this later. Accessory NodeAccessory node acts like a secondary driver node connected to our deformer so they can influence the deformation. In the sample code, our accessory node is a locator which when we connects its world matrix, it will change our mesh’s deformation when translating. Custom Dependency Node vs. Custom Deformer NodeRegistration: In our previous chapter, we register our node using registerNode() with node type: omMPx.MPxNode.kDependNode, in deformer node, we use omMPx.MPxNode.kDeformerNode as our node type. Inheritence: We now inherit our class from omMPx.MPxDeformerNode instead of omMPxNodethere’s still compute() in MPxDeformerNode class, but we want to write our deformation algorithm in deform(). Accessory Node: accessoryNodeSetup(self, dagModifier) and accessoryAttribute(self) is overrided to allow us to control accessory node along with our deformer. Procedurestep 1: Declare attribute (Same as last chapter)step 2: Initialize NodeNode Creator 12def nodeCreator(): return mpx.asMPxPtr(MyDeformer()) Only API 1.0 is available. Node Initializer 12345678910111213141516171819202122232425262728def nodeInitializer(): &#x27;&#x27;&#x27;1: create reference to numericAttribute and matrixAttribute function sets&#x27;&#x27;&#x27; numericAttrFn = om.MFnNumericAttribute() matrixAttrFn = om.MFnMatrixAttribute() &#x27;&#x27;&#x27; 2: create attribute using the function set&#x27;&#x27;&#x27; MyDeformer.inNumAttr = numericAttrFn.create(&#x27;num&#x27;, &#x27;n&#x27;, om.MFnNumericData.kFloat, 0.0) numericAttrFn.setMin(-1.0) numericAttrFn.setMax(1.0) numericAttrFn.setReadable(False) MyDeformer.inMatAttr = numericAttrFn.create(&#x27;matrix&#x27;, &#x27;m&#x27;) matrixAttrFn.setStorable(False) matrixAttrFn.setConnectable(True) &#x27;&#x27;&#x27; 2.5: access built-in attribute using OpenMayaMpx.cvar.MPxGeometryFilter_outputGeom&#x27;&#x27;&#x27; outputGeom = mpx.cvar.MPxGeometryFilter_outputGeom &#x27;&#x27;&#x27; 3: attach attribute&#x27;&#x27;&#x27; MyDeformer.addAttribute(MyDeformer.inNumAttr) MyDeformer.addAttribute(MyDeformer.inMatAttr) &#x27;&#x27;&#x27; 4: add circuit (relationship in-&gt;out)&#x27;&#x27;&#x27; MyDeformer.attributeAffects(MyDeformer.inNumAttr, ouputGeom) MyDeformer.attributeAffects(MyDeformer.inMatAttr, ouputGeom) &#x27;&#x27;&#x27; 5: make attribute paintable&#x27;&#x27;&#x27; cmds.makePaintable(nodeName, &#x27;weights&#x27;, attrType=&#x27;multiFloat&#x27;, shapeMode=&#x27;deformer&#x27;) we access the output Geometry attribute so we can later add relationship to it. RegisterNode 1mplugin.registerNode(nodeName, nodeID, nodeCreator, nodeInitializer, om.MPxNode.kDeformNode) De-registerNode 1mplugin.deregisterNode(nodeID) step 3: Initialize Node （Actual Deform Algorithm）1234567891011121314151617181920212223242526272829303132333435363738394041424344class MyNode(om.MPxDeformNode): inNumAttr = om.MObject() inMatAttr = om.MObject() def __init__(self): om.MPxDeformNode.__init__(self) def deform(self, dataBlock, geomIterator, localToWorldMatrix, geomIndex): # step 1: access built-in attribute value using attribute name and attribute handle envelopeAttr = mpx.cvar.MPxGeometryFilter_envelope envelopeHandle = dataBlock.inputValue(envelopeAttr) envelopeValue = envelopeHandle.asFloat() # step 1.5: access custom attribute value inNumHandle = dataBlock.inputValue(MyDeformer.inNumAttr) inNumValue = inNumHandle.asFloat() # step 1.55: access custom translate value connected to an accessory node inMatHandle = dataBlock.inputValue(MyDeformer.inMatAttr) inMatValue = inNumHandle.asMatrix() transMatrix = om.MTransformationMatrix(inMatValue) # matrix type translateValue = transMatrix.getTranslation(om.MSpace.kObject) # vector type # step 2: access input mesh inputMesh = self.getDeformerInputGeom(dataBlock, geomIndex) # step 2.5: access mesh normals meshFn = om.MFnMesh(inputMesh) normalVectorArray = om.MFloatVectorArray() # create float vector array to store normal vector meshFn.getVertexNormals(False, normalVectorArray, om.MSpace.kObject) # (average normal or not?, the array to store, normal space) # step 3: iterate the mesh vertices and deform it newVertexPosArray = om.MPointArray() # to store new vertices position while not geomIterator.isDone(): vertexPos = geomIterator.position() vertexIndex = geomIterator.index() normalVector = om.MVector(normalVectorArray[vertexIndex]) # built-in function weightValue(dataBlock, geomIndex, vertexIndex) weight = self.weightValue(dataBlock, geomIndex, vertexIndex) # vertexPos.x = vertexPos.x + [calculation of normalVector.x and translateValue[0]] * envelopeValue * weight newVertexPosArray.append(vertexPos) geomIterator.next() geomIterator.setAllPositions(newVertexPosArray) –To access a value from an attribute, we use handle = dataBlock.input/outputValue(MyNode.attr) if we have a custom attribute ‘inNumAttr’:&nbsp;&nbsp;&nbsp;&nbsp;inNumHandle = dataBlock.inputValue(MyDeformer.inNumAttr)&nbsp;&nbsp;&nbsp;&nbsp;inNumValue = inNumHandle.asFloat()if we have a built-in attribte ‘envelope’:&nbsp;&nbsp;&nbsp;&nbsp;# we first get our attribute name ‘envelope’&nbsp;&nbsp;&nbsp;&nbsp;envelopeAttr = mpx.cvar.MPxGeometryFilter_envelope&nbsp;&nbsp;&nbsp;&nbsp;envelopeHandle = dataBlock.inputValue(envelopeAttr)&nbsp;&nbsp;&nbsp;&nbsp;envelopeValue = envelopeHandle.asFloat() –To get normal for individual vertices on our input mesh, we first need to obtain our input mesh using our own function: getDeformerInputGeom(self, dataBlock, geomIndex). And using mesh function set MeshFn’s getVertexNormals() we store the normal vector in om.MFloatVectorArray() type array. –To deform our mesh: we use the geometry iterator to perform iteration on each mesh vertex and re-calculate its position. We combine the use of geoIterator.position() and geomIterator.setPosition(point) or geomIterator.setAllPositions(pointArray). – To access weight value on each vertex, we use built-in function weightValue(dataBlock, geomIndex, vertexIndex). In which, geomIndex is provided in deform() and vertexIndex is from geomIterator. Step 3.1: Get in-Mesh1234567891011def getDeformerInputGeom(self, dataBlock, geomIndex): inputAttr = mpx.cvar.MPxGeometryFilter_input inputHandle = dataBlock.outputArrayValue(inputAttr) # use outputArray instead of inputArray to avoid re-computation inputHandle.jumpToElement(geomIndex) inputElementHandle = inputHandle.outputValue() inputGeomAttr = mpx.cvar.MPxGeometryFilter_inputGeom inputGeomHandle = inputElementHandle.child(inputGeomAttr) # this is different from how we usually get handler inputGeomMesh = inputGeomHandle.asMesh() return inputGeomMesh At this point, I can’t fully interpret the meaning of this segment. Step 4: Accessory Node1234567891011121314151617181920def accessoryNodeSetup(self, dagModifier): # step1: create the accessory node using the supplied dagModifier locator = dagModifier.createNode(&#x27;locator&#x27;) # step2: access accessory node&#x27;s attribute(can&#x27;t use mplug type, has to be mobject type) # access dependency node function set dependNodeFn = om.MFnDependencyNode(locator) matrixPlug = dependNodeFn.findPlug(&#x27;worldMatrix&#x27;) # this returns mplug type attribute, we need mobject type attribute matrixAttr = matrixPlug.attribute() # step3: connect mobject type(required) together # param: accessory node(mobject), accessory attr(mobject), deformer node(mobject: using self.thisMObject()), deformer attr(mobject) mConnectStatus = dagModifier.connect(locator, matrixAttr, self.thisMObject(), MyDeformer.inMatAttr) &#x27;&#x27;&#x27;now the accessory node&#x27;s worldMatrix is driving to the custom in-matrix of the deformer node&#x27;&#x27;&#x27; return mConnectStatusdef accessoryAttribute(self): # returns the deformer node attribute connected return MyDeformer.inMatAttr The dagModifer is supplied in the accessory node. We use dagModifier’s connect function to connect the accessory node’s attribute to our deformer node’s attribute. In this case, we have accessory’s attribute: worldMatrix (a built-in attribute obtained from MFnDependencyNode.findPlug()) and our custom defined MyDeformer.inMatAttr. One thing to note is that, the .connect() only takes MObject which we cannot supply MPlug type object matrixPlug = …findPlug(‘attributeName’), we perform additional step matrixAttr = matrixPlug.attribute() to get the MObject type attribute. Now we supply .connect() with parameters: accessory node (MObject type), accessory node’s attribute (MObject type), deformer node (MObject type) and deformer node’s attribute (MObject type) as follow:mConnectStatus = dagModifier.connect(locator, matrixAttr, self.thisMObject(), MyDeformer.inMatAttr)","categories":[{"name":"learning log","slug":"learning-log","permalink":"http://xingyulei.xyz/categories/learning-log/"}],"tags":[{"name":"python","slug":"python","permalink":"http://xingyulei.xyz/tags/python/"},{"name":"maya","slug":"maya","permalink":"http://xingyulei.xyz/tags/maya/"}]},{"title":"Maya Python API (2. Custom Node)","slug":"maya-api-2","date":"2019-11-10T05:00:00.000Z","updated":"2021-01-11T02:21:03.447Z","comments":true,"path":"2019/11/10/maya-api-2/","link":"","permalink":"http://xingyulei.xyz/2019/11/10/maya-api-2/","excerpt":"","text":"General FormatCustom node SampleAPI 2.0 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697import maya.api.OpenMaya as omimport sysdef maya_useNewAPI(): passnodeName = &#x27;myFirstNode&#x27;nodeID = om.MTypeId(0x55555)nodeClassify = &#x27;utility/general&#x27;class MyNode(om.MPxNode): inRadiusAttr = om.MObject() inTranslateAttr = om.MObject() outRotateAttr = om.MObject() def __init__(self): om.MPxNode.__init__(self) # plug is MPlug type object, dataBlock is MDataBlock type object, refers to the entire datablock of the node def compute(self, plug, dataBlock): if plug == MyNode.outRotateAttr: # step one: get datablock handle (inputValue returns MDataHandle type object) inRadiusHandle = dataBlock.inputValue(MyNode.inRadiusAttr) inTranslateHandle = dataBlock.inputValue(MyNode.inTranslateAttr) outRotateHandle = dataBlock.outputValue(MyNode.outRotateAttr) # step two: extract input value from the handle inRadius = inRadiusHandle.asFloat() inTranslate = inTranslateHandle.asFloat() # step three: create logic and set output value outRotate = inTranslate/(6.18*inRadius) * -360 outRotateHandle.setFloat(outRotate) # step four: mark output plug as clean outRotateHandle.setClean() # unknown plug, unknown error else: return om.kUnknownParameterdef nodeCreator(): return MyNode()def nodeInitializer(): defaultRadius = 2.0 defaultTranslate = 0.0 # step one: create reference to attribute function set such as numericAttribute numericAttrFn = om.MFnNumericAttribute() # step two: create attribute using the function set MyNode.inRadiusAttr = numericAttrFn.create(&#x27;radius&#x27;, &#x27;r&#x27;, om.MFnNumericData.kFloat, defaultRadius) numericAttrFn.readable = True # API1.0: numericAttrFn.setReadable(True) numericAttrFn.writable = True numericAttrFn.storable = True numericAttrFn.hidden = False numericAttrFn.keyable = True MyNode.inTranslateAttr = numericAttrFn.create(&#x27;translate&#x27;, &#x27;t&#x27;, om.MFnNumericData.kFloat, defaultTranslate) numericAttrFn.readable = True numericAttrFn.writable = True numericAttrFn.storable = True numericAttrFn.hidden = False numericAttrFn.keyable = True MyNode.outRotateAttr = numericAttrFn.create(&#x27;rotation&#x27;, &#x27;rot&#x27;, om.MFnNumericData.kFloat) numericAttrFn.readable = True numericAttrFn.writable = False numericAttrFn.storable = False numericAttrFn.hidden = False # step three: attach attribute MyNode.addAttribute(MyNode.inRadiusAttr) MyNode.addAttribute(MyNode.inTranslateAttr) MyNode.addAttribute(MyNode.outRotateAttr) # step four: add circuit (relationship in-&gt;out) MyNode.attributeAffects(MyNode.inRadiusAttr, MyNode.outRotateAttr) MyNode.attributeAffects(MyNode.inTranslateAttr, MyNode.outRotateAttr)def initializePlugin(mobject): mplugin = om.MFnPlugin(mobject) try: mplugin.registerNode(nodeName, nodeID, nodeCreator, nodeInitializer, om.MPxNode.kDependNode, nodeClassify) except: sys.stderr.write(&#x27;fail to register node: &#x27; + nodeName) raisedef uninitializePlugin(mobject): mplugin = om.MFnPlugin(mobject) try: mplugin.deregisterNode(nodeID) except: sys.stderr.write(&#x27;fail to de-register node: &#x27; + nodeName) raise Data block (MDataBlock)Data block refers the entire container of a node. This container stores all the values for each attribute of the node. The datablock of this node is provided in the compute() function. Plug (MPlug)Plug is the outer plug of the node which provides the connections to other node’s plug. The MPlug usually connects the plug from another node and the value of a certain attribute of this node. The plug is also provided in the compute() function Data handle (MDataHandle)Data handle usually stores an attribute’s value. We can set a value to an attribute using MDataHandle.setType(value), and get an attribute’s value using value = MDataHandle.asType(). Procedurestep 1: Declare attribute (MObject) in the class123456789class MyNode(om.MPxNode): inAttr = om.MObject() outAttr = om.MObject() def __init__(self): om.MPxNode.__init__(self) def compute(self, plug, dataBlock): pass inAttr refers to the input attribute that we are creating, outAttr refers to the output attribute that we are creating. Both are declared as MObject() type. We will later access them using MyNode.inAttr and MyNode.outAttr. step 2: Initialize NodeNode Creator 12def nodeCreator(): return MyNode() Node Creator in API 2.0 directly returns an instance to the class, API 1.0 uses a pointer like in command plugin. Node Initializer 123456789101112131415161718def nodeInitializer(): &#x27;&#x27;&#x27;1: create reference to attribute function set such as numericAttribute&#x27;&#x27;&#x27; numericAttrFn = om.MFnNumericAttribute() &#x27;&#x27;&#x27; 2: create attribute using the function set&#x27;&#x27;&#x27; MyNode.inAttr = numericAttrFn.create(&#x27;in&#x27;, &#x27;i&#x27;, om.MFnNumericData.kFloat, 1.0) numericAttrFn.readable = True numericAttrFn.writable = True MyNode.outAttr = numericAttrFn.create(&#x27;out&#x27;, &#x27;o&#x27;, om.MFnNumericData.kFloat) numericAttrFn.readable = True numericAttrFn.writable = False &#x27;&#x27;&#x27; 3: attach attribute&#x27;&#x27;&#x27; MyNode.addAttribute(MyNode.inAttr) MyNode.addAttribute(MyNode.outAttr) &#x27;&#x27;&#x27; 4: add circuit (relationship in-&gt;out)&#x27;&#x27;&#x27; MyNode.attributeAffects(MyNode.inAttr, MyNode.outAttr) MFnNumericAttribute provides the function sets to create attribute for numeric type attribute. There’s also MFnMatrixAttribute to create matrix type attribute and so on. –Using the function set’s create() function, we add parameters for attribute’s long name, short name, data type, and default value (optional). –This returns a MObject type attribute which is attached to the function set. We store it in the attribute declared earlier in the class.–Set the attribute’s property using function set, such as readable, writable, hidden, storable, connectable (In API1.0, use like this numericAttrFn.setReadable(True))3. Using the MyNode.addAttribute(MyNode.inAttr) to attach attribute to the node4. Using the MyNode.attributeAffects(MyNode.inAttr, MyNode.outAttr) to design the affect relationship between attributes, in this case, change of inAttr will affect outAttr. RegisterNode 1mplugin.registerNode(nodeName, nodeID, nodeCreator, nodeInitializer, om.MPxNode.kDependNode, nodeClassify) Parameters: name of the node, id of the node, node creator function, node initializer function, node type (DependNode or DeformNode…), node classification (utility, shading…) Example:&nbsp;&nbsp;&nbsp;&nbsp;nodeID = om.MTypeId(0x55555)&nbsp;&nbsp;&nbsp;&nbsp;nodeClassify = ‘utility/general’ De-registerNode 1mplugin.deregisterNode(nodeID) step 3: Initialize Node12345678910111213141516171819202122232425class MyNode(om.MPxNode): inAttr = om.MObject() outAttr = om.MObject() def __init__(self): om.MPxNode.__init__(self) def compute(self, plug, dataBlock): if plug == MyNode.outAttr: # 1: get datablock handle (inputValue returns MDataHandle type object) inHandle = dataBlock.inputValue(MyNode.inAttr) outHandle = dataBlock.outputValue(MyNode.outAttr) # 2: extract input value from the handle inValue = inHandle.asFloat() # 3: create logic and set output value outValue = inValue * 2 outHandle.setFloat(outValue) # 4: mark output plug as clean outHandle.setClean() else: return om.kUnknownParameter When MyNode.outAttr is dirty (meaning it needs to recompute), we use if plug == MyNode.outAttr: to identify this certain plug. (this if statement will work, even if plug is MPlug type and MyNode.outAttr is MOjbect type) We have already identify what input attribute is affecting this plug, in order to retrieve the value of this input, we need to attach a data handle on the data block specifying this certain input attribute we want to retrive.Therefore we have handle = dataBlock.input/outputValue(MyNode.attr) Next, we use value = handle.asFloat() and handle.setFloat(value) to get and set the value from and to the attribute. (float type as example) Last, we mark the current plug as clean, by setClean() to the outHandle","categories":[{"name":"learning log","slug":"learning-log","permalink":"http://xingyulei.xyz/categories/learning-log/"}],"tags":[{"name":"python","slug":"python","permalink":"http://xingyulei.xyz/tags/python/"},{"name":"maya","slug":"maya","permalink":"http://xingyulei.xyz/tags/maya/"}]},{"title":"Maya Python API (1. Command Plugin with Flags)","slug":"maya-api-1","date":"2019-11-09T05:00:00.000Z","updated":"2021-01-11T02:20:50.272Z","comments":true,"path":"2019/11/09/maya-api-1/","link":"","permalink":"http://xingyulei.xyz/2019/11/09/maya-api-1/","excerpt":"","text":"Maya API IntroOverviewDifferent from Maya Command, Maya API offers more low level access to Maya’s feature.You can think of Maya in multiple layers: Bottom Layer: System OS Maya Core: The entire Maya program written in C++ Maya API: Designated API exposed to developers, which can access Maya Core Maya Command: Helper Functions calling multiple Maya API Maya GUI: User graphics interface While Maya Command (MEL/Python) is most commonly used to write scripts, because it has fast prototyping and easy to learn. The downside is that it is often slow and can’t offer low level access to Maya Core. Maya API on the other hand, is complicated, but offers faster speed and most flexibility. It comes with Python and C++. Python API has version 1.0 and 2.0. difference between Python API vs C++ API API1.0 vs 2.0API 1.0 (Before 2012) has acess to more features offered in C++API 2.0 faster and more pythonic, but some class such as OpenMayaFX, OpenMayaDeformerNode is not supported. General FormatPlug-in SampleAPI 1.0 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960import sysimport maya.OpenMayaMPx as mpximport maya.OpenMaya as ompluginName = &#x27;pyTemplate&#x27;sampleShortFlagName = &#x27;-s&#x27;sampleLongFlagName = &#x27;-sample&#x27;class PyTemplate(mpx.MPxCommand): def __init__(self): mpx.MPxCommand.__init__(self) def doIt(self, args): print &#x27;doIt&#x27; self.parseArgument(args) self.redoIt() def redoIt(self): # this is optional print &#x27;redoIt&#x27; def undoIt(self): # this is also optional print &#x27;undoIt&#x27; def parseArgument(self, args): argData = om.MArgParser(self.syntax(), args) if argData.isFlagSet(sampleShortFlag): self.sample = argData.flagArgumentDouble(sampleShortFlag, 0) print self.sample def isUndoable(self): # this is required when undo and redo is available return Truedef cmdCreator(): return mpx.asMPxPtr(PyParticle())def syntaxCreator(): # use this only when custom argument is defined syntax = om.MSyntax() syntax.addFlag(sampleShortName, sampleLongName, om.MSyntax.kDouble) return syntaxdef initializePlugin(mobject): mplugin = mpx.MFnPlugin(mobject) try: mplugin.registerCommand(pluginName, cmdCreator, syntaxCreator) except: sys.stderr.write(&#x27;fail to register: &#x27; + pluginName) raisedef uninitializePlugin(mobject): mplugin = mpx.MFnPlugin(mobject) try: mplugin.deregisterCommand(pluginName) except: sys.stderr.write(&#x27;fail to de-register: &#x27; + pluginName) raise API 2.0 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748import sysimport maya.OpenMaya as ompluginName = &#x27;pyTemplate&#x27;sampleShortFlagName = &#x27;-s&#x27;sampleLongFlagName = &#x27;-sample&#x27;def maya_useNewAPI(): passclass PyTemplate(mpx.MPxCommand): def __init__(self): mpx.MPxCommand.__init__(self) def doIt(self, args): print &#x27;doIt&#x27; self.parseArgument(args) def parseArgument(self, args): argData = om.MArgParser(self.syntax(), args) if argData.isFlagSet(sampleShortFlag): self.sample = argData.flagArgumentDouble(sampleShortFlag, 0) print self.sampledef cmdCreator(): return PyTemplate()def syntaxCreator(): syntax = om.MSyntax() syntax.addFlag(sampleShortName, sampleLongName, om.MSyntax.kDouble) return syntaxdef initializePlugin(mobject): mplugin = mpx.MFnPlugin(mobject) try: mplugin.registerCommand(pluginName, cmdCreator, syntaxCreator) except: sys.stderr.write(&#x27;fail to register: &#x27; + pluginName) raisedef uninitializePlugin(mobject): mplugin = mpx.MFnPlugin(mobject) try: mplugin.deregisterCommand(pluginName) except: sys.stderr.write(&#x27;fail to de-register: &#x27; + pluginName) raise Difference import module 0 has a seperate maya.OpenMayaMPx along with maya.OpenMaya 0 has maya.api.OpenMaya including the original MPx command maya_useNewAPI 0 use this function to declare using API 2.0 cmd creator 0 uses a MPx pointer object to point to instance of the class 0 director returns the instance of the class other syntax difference will be discussed later Creating Command with Argument and Flags Defination:”Flags” vs “Argument”Take this as an example: cmds.group(‘circle1’, ‘sphere1’, name=’group1’)&nbsp;&nbsp;&nbsp;&nbsp;‘circle1’ and ‘sphere1’ are arguments&nbsp;&nbsp;&nbsp;&nbsp;name is the flag and ‘group1’ is the value Another example: cmds.polyCube(sx=10, axis=[0, 0, 1])&nbsp;&nbsp;&nbsp;&nbsp;no argument is specified&nbsp;&nbsp;&nbsp;&nbsp;sx is the flag’s short name, subdivisionX is the flag’s long name&nbsp;&nbsp;&nbsp;&nbsp;[0, 0, 1] is axis flag’s value, each individual number is called parameters Procedurestep 1: Declare flag name outside the class12345firstFlagShortName = &#x27;-f&#x27;firstFlagLongName = &#x27;-first&#x27;secondFlagShortName = &#x27;-s&#x27;secondFlagLongName = &#x27;-second&#x27;# more flags ... step 2: Add flag and argument in syntax creator outside of class(this syntax creator will be further included in the plugin initialize function) 12345678910111213def syntaxCreator(): &#x27;&#x27;&#x27;create a OpenMaya.MSyntax object to store flags and argument&#x27;&#x27;&#x27; syntax = om.MSyntax() &#x27;&#x27;&#x27;add flags with short name, long name, and value type&#x27;&#x27;&#x27; syntax.addFlag(firstFlagShortName, firstFlagLongName, om.MSyntax.kDouble) syntax.addFlag(secondFlagShortName, secondFlagLongName, (om.MSyntax.kDouble, om.MSyntax.kDouble, om.MSyntax.kDouble)) # add more flags ... &#x27;&#x27;&#x27;add argument using MSyntax.addArg() function&#x27;&#x27;&#x27; &#x27;&#x27;&#x27;add argument is not discussed, refer to document later&#x27;&#x27;&#x27; return syntax step 3: Parsing Flags, called inside the class’s doIt function123456789101112 def parseArguments(self, args): &#x27;&#x27;&#x27;instanitiate MArgParser ojbect, self.syntax() refers to the syntax created in step 2&#x27;&#x27;&#x27; argData = om.MArgParser(self.syntax(), args)&#x27;&#x27;&#x27;check if certain flags are set&#x27;&#x27;&#x27; if argData.isFlagSet(firstFlagShortName): firstValue = argData.flagArgumentString(firstFlagShortName, 0) if argData.isFlagSet(secondFlagShortName): secondParam0 = argData.flagArgumentInt(secondFlagShortName, 0) secondParam1 = argData.flagArgumentInt(secondFlagShortName, 1) secondParam2 = argData.flagArgumentInt(secondFlagShortName, 2) # parse more flags ...","categories":[{"name":"learning log","slug":"learning-log","permalink":"http://xingyulei.xyz/categories/learning-log/"}],"tags":[{"name":"python","slug":"python","permalink":"http://xingyulei.xyz/tags/python/"},{"name":"maya","slug":"maya","permalink":"http://xingyulei.xyz/tags/maya/"}]},{"title":"How to run Maya in Batch Mode","slug":"maya-batch-mode","date":"2019-10-09T04:00:00.000Z","updated":"2021-08-18T03:57:16.352Z","comments":true,"path":"2019/10/09/maya-batch-mode/","link":"","permalink":"http://xingyulei.xyz/2019/10/09/maya-batch-mode/","excerpt":"","text":"Import Maya Standalone Modulecreate a .py file called firstStandalone.py and enter: 12import maya.standalonemaya.standalone.initialize(name=&#x27;python&#x27;) sometimes, error will occur: 1ImportError: No module named maya.standalone TO FIX THIS:first step: check your python intepreter, it should match the maya python2 version.I changed my project intepreter in my pycharm setting. second step: setup system path and environment 1234567891011121314151617181920212223import sysimport os#====================================================================#MAYA_LOCATION = &quot;C:/Program Files/Autodesk/Maya2018&quot;PYTHON_LOCATION = MAYA_LOCATION + &quot;/Python/Lib/site-packages&quot;os.environ[&quot;MAYA_LOCATION&quot;] = MAYA_LOCATIONos.environ[&quot;PYTHONPATH&quot;] = PYTHON_LOCATIONsys.path.append(MAYA_LOCATION)sys.path.append(PYTHON_LOCATION)sys.path.append(MAYA_LOCATION+&quot;/bin&quot;)sys.path.append(MAYA_LOCATION+&quot;/lib&quot;)sys.path.append(MAYA_LOCATION+&quot;/Python&quot;)sys.path.append(MAYA_LOCATION+&quot;/Python/DLLs&quot;)sys.path.append(MAYA_LOCATION+&quot;/Python/Lib&quot;)sys.path.append(MAYA_LOCATION+&quot;/Python/Lib/plat-win&quot;)sys.path.append(MAYA_LOCATION+&quot;/Python/Lib/lib-tk&quot;)print(&#x27;\\n&#x27;.join(sys.path))import maya.standalone as standalonestandalone.initialize(name=&#x27;python&#x27;) if error still occurs, please check your maya directory Add functionsIn my firstStandalone.py file, I added a test function following standalone.initialize 12345678910111213141516def test(): import maya.cmds as cmds # full path to your Maya file to OPEN maya_file_to_open = r&quot;C:\\Users\\Lei\\Desktop\\test.ma&quot; # Open your file cmds.file(maya_file_to_open, o=True) # full path to your Maya file to IMPORT maya_file_to_import = r&quot;C:\\Users\\Lei\\Desktop\\import.ma&quot; # Import the file. the variable &quot;nodes&quot; will hold the names of all nodes imported, just in case. cmds.file(maya_file_to_import, i=True, type=&quot;mayaAscii&quot;) render = r&quot;C:\\Users\\Lei\\Desktop\\te.ma&quot; cmds.file(rename=render) cmds.file(force=True, save=True, options=&#x27;v=1;p=17&#x27;, type=&#x27;mayaBinary&#x27;) print &#x27;a&#x27;test() This test function opens a maya file on my desktop and import a maya file and save out as another file. Execute our fisrtStandalone.pymethod 1: execute from our command lineto do so, make sure to add mayapy to your system environment variable. in system variable: add C:\\Program Files\\Autodesk\\Maya2018\\bin to Path run cmds, and enter mayapy [drag your firstStandalone.py here, our enter the full path] it should be running correctly. method 2: execute using python subprocessto execute your .py, you can do it without going to command line, but by executing from another .py 12345import subprocesscommand = &#x27;mayapy your/directory/firstStandalone.py&#x27;process = subprocess.Popen(command, shell=True, stdout=subprocess.PIPE)process.wait()print(process.returncode) # this return the message from cmd Source:http://discourse.techart.online/t/import-maya-standalone-problem/1437https://stackoverflow.com/questions/27437733/use-external-python-script-to-open-maya-and-run-another-script-inside-mayahttps://stackoverflow.com/questions/17500157/how-to-use-an-external-interpreter-for-mayahttps://www.toadstorm.com/blog/?p=136","categories":[{"name":"tech summary","slug":"tech-summary","permalink":"http://xingyulei.xyz/categories/tech-summary/"}],"tags":[{"name":"python","slug":"python","permalink":"http://xingyulei.xyz/tags/python/"},{"name":"maya","slug":"maya","permalink":"http://xingyulei.xyz/tags/maya/"}]}],"categories":[{"name":"tech summary","slug":"tech-summary","permalink":"http://xingyulei.xyz/categories/tech-summary/"},{"name":"learning log","slug":"learning-log","permalink":"http://xingyulei.xyz/categories/learning-log/"}],"tags":[{"name":"python","slug":"python","permalink":"http://xingyulei.xyz/tags/python/"},{"name":"pyqt","slug":"pyqt","permalink":"http://xingyulei.xyz/tags/pyqt/"},{"name":"style","slug":"style","permalink":"http://xingyulei.xyz/tags/style/"},{"name":"git","slug":"git","permalink":"http://xingyulei.xyz/tags/git/"},{"name":"version control","slug":"version-control","permalink":"http://xingyulei.xyz/tags/version-control/"},{"name":"c#","slug":"c","permalink":"http://xingyulei.xyz/tags/c/"},{"name":"Unity","slug":"Unity","permalink":"http://xingyulei.xyz/tags/Unity/"},{"name":"integration","slug":"integration","permalink":"http://xingyulei.xyz/tags/integration/"},{"name":"C#","slug":"C","permalink":"http://xingyulei.xyz/tags/C/"},{"name":"maya","slug":"maya","permalink":"http://xingyulei.xyz/tags/maya/"}]}